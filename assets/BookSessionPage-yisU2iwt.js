import{j as e}from"./ui-CqCCPo1Y.js";import{r as y}from"./vendor-CsPsgsBv.js";import{L as h}from"./Layout-LrLnQRNT.js";import{c as _,C as b,h as p,d as S,e as M,f as C,B as u,a as I,u as B,s as f}from"./index-Cz0ZLwjf.js";import{u as E}from"./query-2sWkym1G.js";import{S as L}from"./star-BZJzuXdS.js";import{M as $,G as F}from"./map-pin-C8gF0LSJ.js";import{D as U}from"./dollar-sign-CUlpiUT9.js";import{C as O}from"./calendar-D_CFiBTG.js";import{C as q}from"./clock-C9qB3zDw.js";import{b as G,u as H}from"./router-J7O6VmFe.js";import{U as j}from"./user-BHV8TPVD.js";import"./dialog-JXTE8grn.js";import"./supabase-DoZrjKS4.js";import"./utils-EL5wpLGY.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=_("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Y=[{id:"2",name:"Ann Silo",profileImage:"https://i.pravatar.cc/150?img=5",specialization:["Anxiety","Depression","PTSD","Stress Management","Trauma","Grief"],languages:["English","Spanish"],location:"New York, USA",bio:"Experienced mental health consultant with 10+ years of practice.",rating:4.8,reviewCount:124,hourlyRate:85,isOnline:!0,availability:[{day:"Monday",slots:["9:00 AM","11:00 AM","2:00 PM"]},{day:"Wednesday",slots:["10:00 AM","1:00 PM","3:00 PM"]},{day:"Friday",slots:["9:00 AM","12:00 PM","4:00 PM"]}]},{id:"8",name:"Dr. Michael Stevens",profileImage:"https://i.pravatar.cc/150?img=11",specialization:["Trauma","PTSD","Grief Counseling","Anxiety","Depression","Phobias"],languages:["English","French"],location:"Toronto, Canada",bio:"Specializing in trauma recovery and post-traumatic growth.",rating:4.9,reviewCount:187,hourlyRate:95,isOnline:!1,availability:[{day:"Tuesday",slots:["10:00 AM","12:00 PM","2:00 PM"]},{day:"Thursday",slots:["11:00 AM","1:00 PM","3:00 PM"]},{day:"Saturday",slots:["9:00 AM","11:00 AM","1:00 PM"]}]},{id:"9",name:"Sarah Johnson",profileImage:"https://i.pravatar.cc/150?img=12",specialization:["Teen Counseling","Family Therapy","Anxiety","Depression","Self Esteem","Social Skills"],languages:["English"],location:"Chicago, USA",bio:"Helping teens and families navigate mental health challenges.",rating:4.7,reviewCount:98,hourlyRate:75,isOnline:!0,availability:[{day:"Monday",slots:["3:00 PM","4:00 PM","5:00 PM"]},{day:"Wednesday",slots:["3:00 PM","4:00 PM","5:00 PM"]},{day:"Friday",slots:["2:00 PM","3:00 PM","4:00 PM"]}]},{id:"10",name:"Dr. Amara Okafor",profileImage:"https://i.pravatar.cc/150?img=13",specialization:["Cultural Identity","Racial Trauma","Anxiety","Depression","PTSD","Stress"],languages:["English","Igbo","Yoruba"],location:"London, UK",bio:"Specializing in cultural identity issues and racial trauma.",rating:4.9,reviewCount:145,hourlyRate:90,isOnline:!1,availability:[{day:"Tuesday",slots:["9:00 AM","11:00 AM","1:00 PM"]},{day:"Thursday",slots:["10:00 AM","12:00 PM","2:00 PM"]},{day:"Saturday",slots:["10:00 AM","12:00 PM"]}]},{id:"11",name:"Javier Rodriguez",profileImage:"https://i.pravatar.cc/150?img=14",specialization:["Addiction Recovery","Substance Abuse","Anxiety","Depression","Trauma","Stress Management"],languages:["English","Spanish","Portuguese"],location:"Miami, USA",bio:"Helping individuals overcome addiction and build healthier lives.",rating:4.6,reviewCount:112,hourlyRate:80,isOnline:!0,availability:[{day:"Monday",slots:["10:00 AM","1:00 PM","4:00 PM"]},{day:"Wednesday",slots:["11:00 AM","2:00 PM","5:00 PM"]},{day:"Friday",slots:["10:00 AM","1:00 PM","4:00 PM"]}]}];function J({consultant:t}){return e.jsx(b,{className:"sticky top-20 bg-white dark:bg-[#212121] border-gray-200 dark:border-[#1a1a1a]",children:e.jsxs(p,{className:"p-0",children:[e.jsxs("div",{className:"relative aspect-square overflow-hidden rounded-t-lg",children:[e.jsx("img",{src:t.profile_image,alt:t.name,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx(S,{className:"bg-[#025803] text-white text-xs",children:"Available"})})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t.name}),e.jsxs("div",{className:"flex items-center mt-1 text-gray-600 dark:text-gray-300",children:[e.jsx(L,{className:"w-3 h-3 text-yellow-400 mr-1"}),e.jsx("span",{className:"text-xs",children:"4.8 (124 reviews)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx($,{className:"w-3 h-3 mr-2 text-mental-green-600 dark:text-[#025803]"}),e.jsx("span",{className:"text-xs",children:t.location})]}),e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx(F,{className:"w-3 h-3 mr-2 text-mental-green-600 dark:text-[#025803]"}),e.jsx("span",{className:"text-xs",children:t.languages.join(", ")})]}),e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx(U,{className:"w-3 h-3 mr-2 text-mental-green-600 dark:text-[#025803]"}),e.jsxs("span",{className:"text-xs font-medium",children:["$",t.hourly_rate,"/hour"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-gray-900 dark:text-gray-100 mb-1",children:"Specializations"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.specialization?.map(r=>e.jsx(S,{variant:"outline",className:"text-xs px-2 py-0.5 border-gray-200 dark:border-[#1a1a1a] text-gray-700 dark:text-gray-300 bg-gray-50 dark:bg-[#1a1a1a]",children:r},r))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium text-gray-900 dark:text-gray-100 mb-1",children:"About"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 leading-relaxed",children:t.bio})]})]})]})})}function K({schedule:t,selectedDate:r,onDateSelect:l}){return e.jsxs(b,{className:"bg-white dark:bg-[#212121] border-gray-200 dark:border-[#1a1a1a]",children:[e.jsx(M,{className:"pb-3",children:e.jsxs(C,{className:"flex items-center text-base text-gray-900 dark:text-gray-100",children:[e.jsx(O,{className:"w-4 h-4 mr-2 text-mental-green-600 dark:text-[#025803]"}),"Select Date"]})}),e.jsx(p,{children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-7 gap-2",children:t.map(n=>e.jsxs("button",{onClick:()=>l(n.date),className:`
                p-2 rounded-lg border-2 transition-all text-center
                ${r===n.date?"border-mental-green-600 dark:border-[#025803] bg-mental-green-50 dark:bg-[#1a1a1a] text-mental-green-700 dark:text-[#025803]":"border-gray-200 dark:border-[#1a1a1a] hover:border-mental-green-300 dark:hover:border-[#025803] hover:bg-gray-50 dark:hover:bg-[#1a1a1a]"}
              `,children:[e.jsx("div",{className:"text-xs font-medium text-gray-600 dark:text-gray-300 mb-0.5",children:n.day.split(" ")[0]}),e.jsx("div",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100",children:n.day.split(" ").slice(1).join(" ")})]},n.date))})})]})}function Z({schedule:t,selectedDate:r,selectedTime:l,onTimeSelect:n}){const i=t.find(o=>o.date===r);return i?e.jsxs(b,{className:"bg-white dark:bg-[#212121] border-gray-200 dark:border-[#1a1a1a]",children:[e.jsx(M,{className:"pb-3",children:e.jsxs(C,{className:"flex items-center text-base text-gray-900 dark:text-gray-100",children:[e.jsx(q,{className:"w-4 h-4 mr-2 text-mental-green-600 dark:text-[#025803]"}),"Select Time"]})}),e.jsx(p,{children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2",children:i.slots.map(o=>e.jsxs("button",{onClick:()=>n(o.time),disabled:!o.available,className:`
                p-2 rounded-lg border-2 transition-all text-center
                ${o.available?l===o.time?"border-mental-green-600 dark:border-[#025803] bg-mental-green-50 dark:bg-[#1a1a1a] text-mental-green-700 dark:text-[#025803]":"border-gray-200 dark:border-[#1a1a1a] hover:border-mental-green-300 dark:hover:border-[#025803] hover:bg-gray-50 dark:hover:bg-[#1a1a1a]":"border-gray-200 dark:border-[#1a1a1a] bg-gray-100 dark:bg-[#1a1a1a] text-gray-400 dark:text-gray-500 cursor-not-allowed"}
              `,children:[e.jsx("div",{className:"text-xs font-medium",children:o.time}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:o.available?"Available":"Booked"})]},o.time))})})]}):null}function Q({consultant:t,selectedDate:r,selectedTime:l,isLoading:n,onBookSession:i}){return!r||!l?null:e.jsx(b,{className:"border-mental-green-200 dark:border-[#1a1a1a] bg-mental-green-50 dark:bg-[#212121]",children:e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-base font-semibold text-mental-green-800 dark:text-[#025803]",children:"Booking Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Consultant:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:t.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Date:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:new Date(r).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Time:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:l})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Duration:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:"60 minutes"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Total:"}),e.jsxs("span",{className:"font-semibold text-sm text-gray-900 dark:text-gray-100",children:["$",t.hourly_rate]})]})]})]}),e.jsx(u,{onClick:i,disabled:n,className:"w-full bg-mental-green-600 hover:bg-mental-green-700 dark:bg-[#025803] dark:hover:bg-[#014502] text-white py-2 text-sm font-medium",children:n?"Booking...":"Confirm Booking"})]})})})}function xe(){const{consultantId:t}=G(),r=H(),{toast:l}=I(),{user:n}=B(),[i,o]=y.useState(""),[g,v]=y.useState(""),[P,k]=y.useState(!1),{data:x,isLoading:D,error:N}=E({queryKey:["consultant",t],queryFn:async()=>{if(!t)return console.log("No consultant ID provided"),null;console.log("Fetching consultant with ID:",t);const a=Y.find(s=>s.id===t);try{const{data:s,error:d}=await f.from("users").select("id, name, email, profile_image").eq("id",t).eq("role","consultant").maybeSingle();if(d){if(console.log("User fetch error:",d),a)return console.log("Using mock consultant as fallback:",a.name),{id:a.id,name:a.name,email:`${a.name.toLowerCase().replace(" ",".")}@example.com`,profile_image:a.profileImage,specialization:a.specialization,languages:a.languages,location:a.location,bio:a.bio,hourly_rate:a.hourlyRate,available:a.isOnline};throw d}if(!s)return console.log("No consultant user found, trying mock data"),a?(console.log("Found consultant in mock data:",a.name),{id:a.id,name:a.name,email:`${a.name.toLowerCase().replace(" ",".")}@example.com`,profile_image:a.profileImage,specialization:a.specialization,languages:a.languages,location:a.location,bio:a.bio,hourly_rate:a.hourlyRate,available:a.isOnline}):null;console.log("Found consultant user:",s.name);const{data:c}=await f.from("consultants").select("*").eq("id",t).eq("approval_status","approved").maybeSingle(),m=c||{specialization:["General Counseling"],languages:["English"],location:"Remote",bio:"Experienced mental health professional.",hourly_rate:75,available:!0};return console.log("Returning consultant data for:",s.name),{id:s.id,name:s.name,email:s.email,profile_image:s.profile_image||"https://i.pravatar.cc/150?img=2",specialization:m.specialization||["General Counseling"],languages:m.languages||["English"],location:m.location||"Remote",bio:m.bio||"Experienced mental health professional.",hourly_rate:m.hourly_rate||75,available:m.available!==!1}}catch(s){return console.error("Error fetching consultant:",s),a?(console.log("Using mock consultant as final fallback:",a.name),{id:a.id,name:a.name,email:`${a.name.toLowerCase().replace(" ",".")}@example.com`,profile_image:a.profileImage,specialization:a.specialization,languages:a.languages,location:a.location,bio:a.bio,hourly_rate:a.hourlyRate,available:a.isOnline}):(console.log("No fallback data available"),null)}},enabled:!!t,retry:!1,staleTime:5*60*1e3}),A=()=>{const a=[],s=new Date;for(let d=0;d<7;d++){const c=new Date(s);c.setDate(s.getDate()+d);const m={date:c.toISOString().split("T")[0],day:c.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),slots:[{time:"09:00",available:Math.random()>.3},{time:"10:00",available:Math.random()>.3},{time:"11:00",available:Math.random()>.3},{time:"14:00",available:Math.random()>.3},{time:"15:00",available:Math.random()>.3},{time:"16:00",available:Math.random()>.3}]};a.push(m)}return a},[w]=y.useState(A()),T=a=>{o(a),v("")},z=a=>{v(a)},R=async()=>{if(!n){l({title:"Authentication Required",description:"Please log in to book a session",variant:"destructive"}),r("/login");return}if(!i||!g){l({title:"Selection Required",description:"Please select both date and time for your session",variant:"destructive"});return}k(!0);try{const a=`${i}T${g}:00.000Z`,s=new Date(`${i}T${g}:00.000Z`);s.setHours(s.getHours()+1);const d=s.toISOString(),{error:c}=await f.from("sessions").insert({user_id:n.id,consultant_id:t,start_time:a,end_time:d,status:"scheduled",notes:null});if(c)throw c;l({title:"Session Booked Successfully",description:`Your session is scheduled for ${i} at ${g}`}),r("/profile")}catch(a){console.error("Error booking session:",a),l({title:"Booking Failed",description:"Could not book the session. Please try again.",variant:"destructive"})}finally{k(!1)}};return t?D?e.jsx(h,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-[#212121] flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-mental-green-600 dark:border-[#025803] mx-auto"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Loading consultant details..."})]})})}):!x&&N?(console.log("Rendering error state, error:",N,"consultant:",x),e.jsx(h,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-[#212121] flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4 max-w-md",children:[e.jsx(j,{className:"w-16 h-16 text-gray-400 dark:text-gray-500 mx-auto"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-gray-200",children:"Consultant Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"The consultant you're looking for is not available."}),e.jsx(u,{onClick:()=>r("/consult"),className:"bg-mental-green-600 hover:bg-mental-green-700 dark:bg-[#025803] dark:hover:bg-[#014502]",children:"Browse Consultants"})]})})})):x?(console.log("Rendering booking page for consultant:",x.name),e.jsx(h,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-[#212121]",children:[e.jsx("div",{className:"sticky top-0 z-40 bg-white dark:bg-[#212121] border-b border-gray-200 dark:border-[#1a1a1a] shadow-sm",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(u,{variant:"ghost",size:"sm",onClick:()=>r("/consult"),className:"text-gray-600 dark:text-gray-300 hover:text-mental-green-600 dark:hover:text-[#025803]",children:[e.jsx(W,{className:"w-5 h-5 mr-1"}),"Back"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Book Session"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Schedule your consultation"})]})]})})})}),e.jsx("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(J,{consultant:x})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx(K,{schedule:w,selectedDate:i,onDateSelect:T}),i&&e.jsx(Z,{schedule:w,selectedDate:i,selectedTime:g,onTimeSelect:z}),e.jsx(Q,{consultant:x,selectedDate:i,selectedTime:g,isLoading:P,onBookSession:R})]})]})})]})})):e.jsx(h,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-[#212121] flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4 max-w-md",children:[e.jsx(j,{className:"w-16 h-16 text-gray-400 dark:text-gray-500 mx-auto"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-gray-200",children:"Consultant Not Found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"The consultant you're looking for is not available."}),e.jsx(u,{onClick:()=>r("/consult"),className:"bg-mental-green-600 hover:bg-mental-green-700 dark:bg-[#025803] dark:hover:bg-[#014502]",children:"Browse Consultants"})]})})}):e.jsx(h,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-[#212121] flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4 max-w-md",children:[e.jsx(j,{className:"w-16 h-16 text-gray-400 dark:text-gray-500 mx-auto"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-gray-200",children:"Invalid Request"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"No consultant ID provided."}),e.jsx(u,{onClick:()=>r("/consult"),className:"bg-mental-green-600 hover:bg-mental-green-700 dark:bg-[#025803] dark:hover:bg-[#014502]",children:"Browse Consultants"})]})})})}export{xe as BookSessionPage,xe as default};
